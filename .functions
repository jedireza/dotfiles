# Create a new directory and enter it
function mkd() {
  mkdir -p "$@" && cd "$@"
}

# Determine size of a file or total size of a directory
function fs() {
  if du -b /dev/null > /dev/null 2>&1; then
    local arg=-sbh
  else
    local arg=-sh
  fi
  if [[ -n "$@" ]]; then
    du $arg -- "$@"
  else
    du $arg .[^.]* *
  fi
}

# Create a data URL from a file
function dataurl() {
  local mimeType=$(file -b --mime-type "$1")
  if [[ $mimeType == text/* ]]; then
    mimeType="${mimeType};charset=utf-8"
  fi
  echo "data:${mimeType};base64,$(openssl base64 -in "$1" | tr -d '\n')"
}

# Helper to refresh tmux env
if [ -n "$TMUX" ]; then
  function tmux_ssh_refresh {
    export $(tmux show-environment | grep "^SSH_AUTH_SOCK") &> /dev/null
    export $(tmux show-environment | grep "^SSH_AUTH_CONNECTION") &> /dev/null
    export $(tmux show-environment | grep "^DISPLAY") &> /dev/null
  }
else
  function tmux_ssh_refresh { }
fi
